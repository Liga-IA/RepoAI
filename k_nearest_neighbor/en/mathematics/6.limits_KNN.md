# Mathematical Limitations of KNN

## Bias and Variance Dependent on k and Dimensionality

The expected error of the KNN estimator can be decomposed into bias and variance. The choice of k directly influences the balance between these two terms:

- **Low k** → Low bias, high variance
- **High k** → High bias, low variance

## The Mathematical Formula for Expected Error

The formula for expected error in a statistical estimation or modeling context is given by:

$$
E\left[( r_k(X) - r(X) )^2 \right] = K \cdot \frac{k^{2/d}}{n^{2/d}}  + \frac{\sigma^2}{k}
$$

### Meaning of Each Term

- **$E\left[( r_k(X) - r(X) )^2 \right]$**: expected mean squared error.
- **k**: number of neighbors.
- **n**: sample size (number of training data).
- **d**: number of dimensions.
- **$sigma^2$**: variance of the errors (associated with noise).
- **K**: constant proportional to the smoothness of the true function **r(x)**.

## Example Calculation

Let's use the following values as an example:

- **k = 5**
- **n = 500**
- **d = 10**
- **$sigma^2 = 1$**
- **K = 1** (for simplicity)

Substituting into the formula:

$$
E\left[( r_k(X) - r(X) )^2 \right] = 1 \cdot \frac{5^{2/10}}{500^{2/d}}  + \frac{1}{k}
$$

Calculating:

$$
E\left[( r_k(X) - r(X) )^2 \right] = 0.589 
$$

This shows that as the dimensionality **d** increases, convergence becomes slower and the quality of the model deteriorates — the rate of convergence decreases exponentially with \( d \).

## Requires Smoothness of the Target Function

The theoretical analysis assumes that the regression function is L-Lipschitz, meaning it varies smoothly. Otherwise, KNN can be mathematically unstable for predictions in regions with highly nonlinear behavior.

## References
IZBICKI RAFAEL & MENDONÇA D.S. TIAGO, São Paulo, 2020. Aprendizado de Máquina: uma abordagem estatística.

O'REILLY, Rio de Janeiro, 2019. Mãos à Obras Aprendizado Máquina com Scikit-Learn e TensorFlow.

## Contributors
|  [<img loading="lazy" src="https://avatars.githubusercontent.com/u/153019298?v=4" width=115><br><sub>Seidi Ducher</sub>](https://github.com/seidiDucher)
| :---: | 


