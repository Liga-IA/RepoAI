
# Limitações Matemáticas do KNN

## Viés e Variância Dependentes de k e da Dimensionalidade

O erro esperado do estimador KNN pode ser decomposto em viés e variância. A escolha de k influencia diretamente o equilíbrio entre esses dois termos:

- **Baixo k** → Baixo viés, alta variância
- **Alto k** → Alto viés, baixa variância

## A Fórmula Matemática do Erro Esperado

A fórmula do erro esperado em um contexto de estimativa ou modelagem estatística é dada por:

$$
E\left[( r_k(X) - r(X) )^2 \right] = K \cdot \frac{k^{2/d}}{n^{2/d}}  + \frac{\sigma^2}{k}
$$

### Significado de Cada Termo

- **$E\left[( r_k(X) - r(X) )^2 \right]$**: erro quadrático médio esperado.
- **k**: número de vizinhos.
- **n** : tamanho da amostra (número de dados de treinamento).
- **d**: número de dimensões.
- **$sigma^2$** : variância dos erros (associada ao ruído).
- **K**: constante proporcional à suavidade da função verdadeira **r(x)**.

## Exemplo de Cálculo

Vamos usar os seguintes valores como exemplo:

- **k = 5**
- **n = 500**
- **d = 10**
- **$sigma^2 = 1$**
- **K = 1** (por simplicidade)

Substituindo na fórmula:

$$
E\left[( r_k(X) - r(X) )^2 \right] = 1 \cdot \frac{5^{2/10}}{500^{2/d}}  + \frac{1}{k}
$$

Calculando:

$$
E\left[( r_k(X) - r(X) )^2 \right] = 0,589 
$$

Isso mostra que, à medida que a dimensionalidade **d** aumenta, a convergência fica mais lenta e a qualidade do modelo piora — a taxa de convergência cai exponencialmente com \( d \).

## Exige Suavidade da Função Alvo

A análise teórica assume que a função de regressão é L-Lipschitz, ou seja, suavemente variável. Caso contrário, o KNN pode ser matematicamente instável para prever em regiões com comportamento muito não linear.

## Referências
IZBICKI RAFAEL & MENDONÇA D.S. TIAGO, São Paulo, 2020. Aprendizado de Máquina: uma abordagem estatística.

O'REILLY, Rio de Janeiro, 2019. Mãos à Obras Aprendizado Máquina com Scikit-Learn e TensorFlow.


## Colaboradores
|  [<img loading="lazy" src="https://avatars.githubusercontent.com/u/153019298?v=4" width=115><br><sub>Seidi Ducher</sub>](https://github.com/seidiDucher)  
| :---: |