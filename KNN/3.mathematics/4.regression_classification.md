# English version

## Regression Formulation

The **k-nearest neighbours (KNN)** method is one of the most popular in the machine learning community.

The idea is to estimate the regression function **r(x)** for a given configuration **x** , using the average of the responses **$y_i$** of the  k  nearest neighbors to  x :

$$
g(x) = \frac{1}{k} \sum_{i‚ààN_x} y_i
$$


Where:
- **$N_x$**: set of the **k** observations closest to **x** 

**$N_x$** = \{i ‚àà \{1,..., n\} : d($x_i$, x) **$d_x^k$**\}

- **$d_x^k$**: distance from the **k** -th nearest neighbor of  **x**

The choice of **k** is made via cross-validation:
- Large **k**: high bias, low variance
- Small **k**: low bias, high variance


### Example: Estimating Property Price

| Property | Size (m¬≤) | Rooms | Price (R$) |
|----------|------------|--------|------------|
| 01       | 110        | 3      | 550,000    |
| 02       | 80         | 2      | 400,000    |
| 03       | 140        | 4      | 650,000    |
| 04       | 70         | 2      | 300,000    |
| 05       | 90         | 3      | 450,000    |

New property: Size = 100 m¬≤, Rooms = 3, k = 3

Euclidean Distance:  

$$
\text{dist} = \sqrt{(size_i - 100)^2 + (rooms_i - 3)^2}
$$

| Property | Distance to (100,3) |
|----------|----------------------|
| 01       | 10,00                |
| 02       | 20,02                |
| 03       | 40,01                |
| 04       | 30,02                |
| 05       | 10,00                |

Selected neighbors: 01, 05, 02  
Prices: 550.000  ; 450.000  ; 400.000

$$
g(x) = \frac{1}{3}(550.000 + 450.000 + 400.000) = 466.666,67~R\$
$$
<div align="center">
  <img src="./Figures/grafic_ex1.png" alt="initial-banner" width="800">
</div>
---

## Classification Formulation

KNN can also be used for classification. The classifier is:

$$
g(x) = \text{mode}_{i \in N_x} y_i
$$

That is, the most frequent class among the \( k \) nearest neighbors of \( x \).

### Example: Heart Disease Diagnosis

| ID | Resting Heart Rate (bpm) | Cholesterol (mg/dL) | Diagnosis        |
|----|---------------------------|----------------------|------------------|
| 01 | 82                        | 220                  | Heart Disease    |
| 02 | 70                        | 190                  | No Disease       |
| 03 | 90                        | 210                  | Heart Disease    |
| 04 | 72                        | 180                  | No Disease       |
| 05 | 85                        | 220                  | Heart Disease    |

New patient: Heart Rate = 78 bpm, Cholesterol = 200 mg/dL, \( k = 3 \)

Euclidean Distance:

$$
\text{dist} = \sqrt{(rate_i - 78)^2 + (chol_i - 200)^2}
$$

| ID | Distance | Diagnosis       |
|----|----------|------------------|
| 02 | 12.81    | No Disease       |
| 03 | 15.62    | Heart Disease    |
| 01 | 20.40    | Heart Disease    |

Mode: **Heart Disease**

The new patient is classified as **Heart Disease** based on KNN with k=3.

<div align="center">
  <img src="./Figures/grafic_ex2.png" alt="initial-banner" width="800">
</div>

## References
IZBICKI RAFAEL & MENDON√áA D.S. TIAGO, S√£o Paulo, 2020. Aprendizado de M√°quina: uma abordagem estat√≠stica.

O'REILLY, Rio de Janeiro, 2019. M√£os √† Obras Aprendizado M√°quina com Scikit-Learn e TensorFlow.

## **Where am I?**
```text
RepoAI/
‚îî‚îÄ‚îÄ KNN/
    ‚îú‚îÄ‚îÄ 1.Concepts/
    ‚îÇ   ‚îî‚îÄ‚îÄ 1.History.md
    |   ‚îî‚îÄ‚îÄ 2.ClassiferVsRegression.md
    |   ‚îî‚îÄ‚îÄ 3.How_to_determine_the_value_of_k.md
    |   ‚îî‚îÄ‚îÄ 4.Typical_problems.md
    |   ‚îî‚îÄ‚îÄ 4.Fields_of_use.md
    ‚îî‚îÄ‚îÄ 2.Code/
    |   ‚îî‚îÄ‚îÄ Figures/
    |   ‚îî‚îÄ‚îÄ 
    ‚îú‚îÄ‚îÄ 3.Mathematics/
    |   ‚îî‚îÄ‚îÄ Figures/
    |   ‚îî‚îÄ‚îÄ 1.generalldeas.md 
    |   ‚îî‚îÄ‚îÄ 2.distances.md  
    |   ‚îî‚îÄ‚îÄ 3.regressionAndclassification.md   
    |   ‚îî‚îÄ‚îÄ 4.Regression_classification_KNN.md <---- You are here!! 
    |   ‚îî‚îÄ‚îÄ 5.Computational_Consideration_KNN.md
    |   ‚îî‚îÄ‚îÄ 6.Limits_KNN.md 
```
## üëæ **Contributors**
|  [<img loading="lazy" src="https://avatars.githubusercontent.com/u/153019298?v=4" width=115><br><sub>Seidi Ducher</sub>](https://github.com/seidiDucher) 
| :---: | 


---
# Portuguese version
---

## Formula√ß√£o de Regress√£o

O m√©todo dos **k-vizinhos mais pr√≥ximos (KNN)** √© um dos mais populares na comunidade de aprendizado de m√°quina.

A ideia √© estimar a fun√ß√£o de regress√£o **r(x)** para uma determinada configura√ß√£o **x**, utilizando a m√©dia das respostas **$y_i$** dos  k  vizinhos mais pr√≥ximos de  x:

$$
g(x) = \frac{1}{k} \sum_{i‚ààN_x} y_i
$$

Onde:
- **$N_x$**: conjunto das **k** observa√ß√µes mais pr√≥ximas de **x**  

**$N_x$** = \{i ‚àà \{1,..., n\} : d($x_i$, x) ‚â§ **$d_x^k$**\}

- **$d_x^k$**: dist√¢ncia do **k**-√©simo vizinho mais pr√≥ximo de  **x**

A escolha de **k** √© feita por valida√ß√£o cruzada:
- **k** grande: alto vi√©s, baixa vari√¢ncia
- **k** pequeno: baixo vi√©s, alta vari√¢ncia

<div align="center">
  <img src="./Figures/fig_regre.png" alt="banner-inicial" width="800">
</div>

### Exemplo: Estimando o Pre√ßo de um Im√≥vel

| Im√≥vel | Tamanho (m¬≤) | Quartos | Pre√ßo (R$) |
|--------|---------------|---------|------------|
| 01     | 110           | 3       | 550.000    |
| 02     | 80            | 2       | 400.000    |
| 03     | 140           | 4       | 650.000    |
| 04     | 70            | 2       | 300.000    |
| 05     | 90            | 3       | 450.000    |

Novo im√≥vel: Tamanho = 100 m¬≤, Quartos = 3, k = 3

Dist√¢ncia Euclidiana:  

$$
\text{dist} = \sqrt{(tamanho_i - 100)^2 + (quartos_i - 3)^2}
$$

| Im√≥vel | Dist√¢ncia at√© (100,3) |
|--------|------------------------|
| 01     | 10,00                  |
| 02     | 20,02                  |
| 03     | 40,01                  |
| 04     | 30,02                  |
| 05     | 10,00                  |

Vizinhos selecionados: 01, 05, 02  
Pre√ßos: 550.000 ; 450.000 ; 400.000

$$
g(x) = \frac{1}{3}(550.000 + 450.000 + 400.000) = 466.666,67~R\$
$$

<div align="center">
  <img src="./Figures/grafic_ex1.png" alt="banner-inicial" width="800">
</div>

---

## Formula√ß√£o de Classifica√ß√£o

O KNN tamb√©m pode ser usado para classifica√ß√£o. O classificador √©:

$$
g(x) = \text{moda}_{i \in N_x} y_i
$$

Ou seja, a classe mais frequente entre os \( k \) vizinhos mais pr√≥ximos de \( x \).

### Exemplo: Diagn√≥stico de Doen√ßa Card√≠aca

| ID | Freq. Card√≠aca Repouso (bpm) | Colesterol (mg/dL) | Diagn√≥stico     |
|----|-------------------------------|----------------------|------------------|
| 01 | 82                            | 220                  | Doen√ßa Card√≠aca |
| 02 | 70                            | 190                  | Sem Doen√ßa      |
| 03 | 90                            | 210                  | Doen√ßa Card√≠aca |
| 04 | 72                            | 180                  | Sem Doen√ßa      |
| 05 | 85                            | 220                  | Doen√ßa Card√≠aca |

Novo paciente: Freq. card√≠aca = 78 bpm, Colesterol = 200 mg/dL, \( k = 3 \)

Dist√¢ncia Euclidiana:

$$
\text{dist} = \sqrt{(freq_i - 78)^2 + (colest_i - 200)^2}
$$

| ID | Dist√¢ncia | Diagn√≥stico     |
|----|-----------|------------------|
| 02 | 12,81     | Sem Doen√ßa      |
| 03 | 15,62     | Doen√ßa Card√≠aca |
| 01 | 20,40     | Doen√ßa Card√≠aca |

Moda: **Doen√ßa Card√≠aca**

O novo paciente √© classificado como **Doen√ßa Card√≠aca** com KNN de \( k = 3 \).

<div align="center">
  <img src="./Figures/grafic_ex2.png" alt="banner-inicial" width="800">
</div>

## Refer√™ncias
IZBICKI RAFAEL & MENDON√áA D.S. TIAGO, S√£o Paulo, 2020. Aprendizado de M√°quina: uma abordagem estat√≠stica.

O'REILLY, Rio de Janeiro, 2019. M√£os √† Obras Aprendizado M√°quina com Scikit-Learn e TensorFlow.

## **Onde estou?**
```text
RepoAI/
‚îî‚îÄ‚îÄ KNN/
    ‚îú‚îÄ‚îÄ 1.Conceitos/
    ‚îÇ   ‚îî‚îÄ‚îÄ 1.Hist√≥ria.md
    |   ‚îî‚îÄ‚îÄ 2.ClassificadorVsRegressao.md
    |   ‚îî‚îÄ‚îÄ 3.Como_determinar_o_valor_de_k.md
    |   ‚îî‚îÄ‚îÄ 4.Problemas_t√≠picos.md
    |   ‚îî‚îÄ‚îÄ 4.√Åreas_de_aplica√ß√£o.md
    ‚îî‚îÄ‚îÄ 2.C√≥digo/
    |   ‚îî‚îÄ‚îÄ Figuras/
    ‚îú‚îÄ‚îÄ 3.Matem√°tica/
    |   ‚îî‚îÄ‚îÄ Figuras/
    |   ‚îî‚îÄ‚îÄ 1.Ideias_gerais.md 
    |   ‚îî‚îÄ‚îÄ 2.Dist√¢ncias.md 
    |   ‚îî‚îÄ‚îÄ 3.RegressaoEclassificacao.md 
    |   ‚îî‚îÄ‚îÄ 4.Regressao_classificacao.md <---- Voc√™ est√° aqui!! 
    |   ‚îî‚îÄ‚îÄ 5.Computacao_Considera√ß√µes_KNN.md
    |   ‚îî‚îÄ‚îÄ 6.Limites_KNN.md     
```
## üëæ Colaboradores
|  [<img loading="lazy" src="https://avatars.githubusercontent.com/u/153019298?v=4" width=115><br><sub>Seidi Ducher</sub>](https://github.com/seidiDucher)  
| :---: | 


