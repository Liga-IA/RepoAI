# English version

## Regression Formulation

The **k-nearest neighbours (KNN)** method is one of the most popular in the machine learning community.

The idea is to estimate the regression function **r(x)** for a given configuration **x** , using the average of the responses **$y_i$** of the  k  nearest neighbors to  x :

$$
g(x) = \frac{1}{k} \sum_i \mathcal{N}(x \mid y_i)
$$



Where:
- **$N_x$**: set of the **k** observations closest to **x** 

**$N_x$** = \{i in \{1,..., n\} : d($x_i$, x) **$d_x^k$**\}

- **$d_x^k$**: distance from the **k** -th nearest neighbor of  **x**

The choice of **k** is made via cross-validation:
- Large **k**: high bias, low variance
- Small **k**: low bias, high variance

### Example: Estimating Property Price

| Property | Size (mÂ²) | Rooms | Price (R$) |
|----------|------------|--------|------------|
| 01       | 110        | 3      | 550,000    |
| 02       | 80         | 2      | 400,000    |
| 03       | 140        | 4      | 650,000    |
| 04       | 70         | 2      | 300,000    |
| 05       | 90         | 3      | 450,000    |

New property: Size = 100 mÂ², Rooms = 3, k = 3

Euclidean Distance:  
$$
\text{dist} = \sqrt{(size_i - 100)^2 + (rooms_i - 3)^2}
$$

| Property | Distance to (100,3) |
|----------|----------------------|
| 01       | 10.00                |
| 02       | 20.02                |
| 03       | 40.01                |
| 04       | 30.02                |
| 05       | 10.00                |

Selected neighbors: 01, 05, 02  
Prices: 550,000; 450,000; 400,000

\[
g(x) = \frac{1}{3}(550,000 + 450,000 + 400,000) = 466,666.67~R\$
\]
<div align="center">
  <img src="./Figures/grafic_ex1.jpg" alt="initial-banner" width="800">
</div>
---

## Classification Formulation

KNN can also be used for classification. The classifier is:

\[
g(x) = \text{mode}_{i \in N_x} y_i
\]

That is, the most frequent class among the \( k \) nearest neighbors of \( x \).

### Example: Heart Disease Diagnosis

| ID | Resting Heart Rate (bpm) | Cholesterol (mg/dL) | Diagnosis        |
|----|---------------------------|----------------------|------------------|
| 01 | 82                        | 220                  | Heart Disease    |
| 02 | 70                        | 190                  | No Disease       |
| 03 | 90                        | 210                  | Heart Disease    |
| 04 | 72                        | 180                  | No Disease       |
| 05 | 85                        | 220                  | Heart Disease    |

New patient: Heart Rate = 78 bpm, Cholesterol = 200 mg/dL, \( k = 3 \)

Euclidean Distance:

\[
\text{dist} = \sqrt{(rate_i - 78)^2 + (chol_i - 200)^2}
\]

| ID | Distance | Diagnosis       |
|----|----------|------------------|
| 02 | 12.81    | No Disease       |
| 03 | 15.62    | Heart Disease    |
| 01 | 20.40    | Heart Disease    |

Mode: **Heart Disease**

The new patient is classified as **Heart Disease** based on KNN with k=3.

<div align="center">
  <img src="./Figures/grafic_ex2.jpg" alt="initial-banner" width="800">
</div>

## **Where am I?**
```text
RepoAI/
â””â”€â”€ KNN/
    â”œâ”€â”€ 1.Concepts/
    â”‚   â””â”€â”€ 1.History.md
    |   â””â”€â”€ 2.ClassiferVsRegression.md
    |   â””â”€â”€ 3.How_to_determine_the_value_of_k.md
    |   â””â”€â”€ 4.Typical_problems.md
    |   â””â”€â”€ 4.Fields_of_use.md
    â””â”€â”€ 2.Code/
    |   â””â”€â”€ Figures/
    |   â””â”€â”€ 
    â”œâ”€â”€ 3.Mathematics/
    |   â””â”€â”€ Figures/
    |   â””â”€â”€ 1.generalldeas.md 
    |   â””â”€â”€ 2.distances.md  
    |   â””â”€â”€ 3.regression_classification.md <---- You are here!!     
```
## ðŸ‘¾ **Contributors**
|  [<img loading="lazy" src="https://avatars.githubusercontent.com/u/153019298?v=4" width=115><br><sub>Seidi Ducher</sub>](https://github.com/seidiDucher)

